val taxiDF = sqlContext.read.format("com.databricks.spark.csv").option("header", "true").load("/user/yw2504/finalProject/yellow/2016/*.csv")
taxiDF.registerTempTable("trip")
val DF = sqlContext.sql("select * from trip where VendorID not like '%end%'")

DF.registerTempTable("DF")
val df = sqlContext.sql("select pickup_latitude, pickup_longitude from DF")

import org.apache.spark.sql.types.DoubleType

val df2 = df.
withColumn("pickup_latitudeTmp", df("pickup_latitude").cast(DoubleType)).drop("pickup_latitude").withColumnRenamed("pickup_latitudeTmp", "pickup_latitude").
withColumn("pickup_longitudeTmp", df("pickup_longitude").cast(DoubleType)).drop("pickup_longitude").withColumnRenamed("pickup_longitude", "pickup_longitude")