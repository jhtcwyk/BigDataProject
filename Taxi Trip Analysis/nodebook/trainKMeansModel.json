{"paragraphs":[{"text":"//set the features for the pickup position\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.ml.feature.VectorAssembler\nval assembler_pickup_p = new VectorAssembler().setInputCols(Array(\"pickup_latitude\", \"pickup_longitude\")).setOutputCol(\"features\")\nval featureVector_pickup_p = assembler_pickup_p.transform(wtDF).select(\"features\").cache()\n","user":"anonymous","dateUpdated":"2017-05-07T21:07:29-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.linalg.Vectors\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nassembler_pickup_p: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_4361d401d6d6\n\nfeatureVector_pickup_p: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [features: vector]\n"}]},"apps":[],"jobName":"paragraph_1494178979232_1973428664","id":"20170507-134259_561713373","dateCreated":"2017-05-07T13:42:59-0400","dateStarted":"2017-05-07T21:07:29-0400","dateFinished":"2017-05-07T21:07:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14546"},{"text":"//train the kmeans model\nimport org.apache.spark.ml.clustering.KMeans\nval kmeans = new KMeans().setK(150).setFeaturesCol(\"features\").setPredictionCol(\"prediction\").setMaxIter(3)\nval model_pickup = kmeans.fit(featureVector_pickup_p)\n//save the model\nmodel_pickup.save(\"/user/yw2504/finalProject/kMeansModel3\")","user":"anonymous","dateUpdated":"2017-05-07T21:13:36-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.clustering.KMeans\n\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_e37426b64276\n\nmodel_pickup: org.apache.spark.ml.clustering.KMeansModel = kmeans_e37426b64276\n"}]},"apps":[],"jobName":"paragraph_1494179042243_815627279","id":"20170507-134402_991440552","dateCreated":"2017-05-07T13:44:02-0400","dateStarted":"2017-05-07T21:13:36-0400","dateFinished":"2017-05-07T23:06:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14547"},{"text":"//train the kmeans model\nimport org.apache.spark.ml.clustering.KMeans\nval kmeans = new KMeans().setK(80).setFeaturesCol(\"features\").setPredictionCol(\"prediction\").setMaxIter(10)\nval model_pickup = kmeans.fit(featureVector_pickup_p)\n//save the model\nmodel_pickup.save(\"/user/yw2504/finalProject/kMeansModel2\")","user":"anonymous","dateUpdated":"2017-05-07T15:40:37-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.clustering.KMeans\n\nkmeans: org.apache.spark.ml.clustering.KMeans = kmeans_ec9a810e3acf\n\nmodel_pickup: org.apache.spark.ml.clustering.KMeansModel = kmeans_ec9a810e3acf\n"}]},"apps":[],"jobName":"paragraph_1494186014781_599910599","id":"20170507-154014_880834248","dateCreated":"2017-05-07T15:40:14-0400","dateStarted":"2017-05-07T15:40:37-0400","dateFinished":"2017-05-07T16:08:28-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14548"},{"text":"//load the model\nimport org.apache.spark.ml.clustering.{KMeansModel}\nval model_pickup = KMeansModel.load(\"/user/yw2504/finalProject/kMeansModel3\")","user":"anonymous","dateUpdated":"2017-05-09T20:19:25-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.ml.clustering.KMeansModel\n\nmodel_pickup: org.apache.spark.ml.clustering.KMeansModel = kmeans_e37426b64276\n"}]},"apps":[],"jobName":"paragraph_1494179366553_438849192","id":"20170507-134926_1085800147","dateCreated":"2017-05-07T13:49:26-0400","dateStarted":"2017-05-09T20:19:25-0400","dateFinished":"2017-05-09T20:49:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14549"},{"text":"import org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.ml.feature.VectorAssembler\nval assembler_pickupCluster = new VectorAssembler().setInputCols(Array(\"pickup_latitude\", \"pickup_longitude\")).setOutputCol(\"features\")\nval featureVector_pickupCluster = assembler_pickupCluster.transform(wtDF).cache()//.drop(\"pickup_longitude\").drop(\"pickup_latitude\").cache()\nval clusterDF =  model_pickup.transform(featureVector_pickupCluster).withColumnRenamed(\"prediction\", \"pickupCluster\").drop(\"features\")\n","user":"anonymous","dateUpdated":"2017-05-09T21:00:25-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.mllib.linalg.Vectors\n\nimport org.apache.spark.ml.feature.VectorAssembler\n\nassembler_pickupCluster: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_e74118773de8\n\nfeatureVector_pickupCluster: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [year: int, month: int ... 8 more fields]\n\nclusterDF: org.apache.spark.sql.DataFrame = [year: int, month: int ... 8 more fields]\n"}]},"apps":[],"jobName":"paragraph_1494179484871_-1068476050","id":"20170507-135124_1258178125","dateCreated":"2017-05-07T13:51:24-0400","dateStarted":"2017-05-09T21:00:25-0400","dateFinished":"2017-05-09T21:00:27-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14550"},{"text":"val center = model_pickup.clusterCenters","user":"anonymous","dateUpdated":"2017-05-08T23:05:28-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"center: Array[org.apache.spark.ml.linalg.Vector] = Array([40.767831206521464,-73.90934096206878], [40.72076923874637,-73.99865679044414], [40.773803995202236,-73.96256506390179], [40.74345472611249,-74.00537357980225], [40.64271085828484,-73.78906810984132], [40.77379137137322,-73.8737506301135], [40.766899610194315,-73.98507065827906], [40.6812428705124,-73.99849349251919], [40.732936633104416,-73.97945874942637], [40.84377903634102,-73.94061068092084], [40.78560228339275,-73.9784914639464], [40.74329422209873,-73.98663547825856], [40.74979210640794,-74.0042251469882], [40.70682476799554,-74.0068356425778], [40.70055893716855,-73.9272043060332], [40.757939606552725,-73.97121888345923], [40.64695121142032,-73.78948684595835], [40.707432369923744,-73.81832235167411], [40.714256030826796,..."}]},"apps":[],"jobName":"paragraph_1494191728516_-2064910142","id":"20170507-171528_2074018744","dateCreated":"2017-05-07T17:15:28-0400","dateStarted":"2017-05-08T23:05:28-0400","dateFinished":"2017-05-08T23:05:28-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14551"},{"text":"for( a <- 0 to 149){\n    println(center(a)(0)+\",\"+center(a)(1))\n}","user":"anonymous","dateUpdated":"2017-05-08T23:16:29-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"40.767831206521464,-73.90934096206878\n40.72076923874637,-73.99865679044414\n40.773803995202236,-73.96256506390179\n40.74345472611249,-74.00537357980225\n40.64271085828484,-73.78906810984132\n40.77379137137322,-73.8737506301135\n40.766899610194315,-73.98507065827906\n40.6812428705124,-73.99849349251919\n40.732936633104416,-73.97945874942637\n40.84377903634102,-73.94061068092084\n40.78560228339275,-73.9784914639464\n40.74329422209873,-73.98663547825856\n40.74979210640794,-74.0042251469882\n40.70682476799554,-74.0068356425778\n40.70055893716855,-73.9272043060332\n40.757939606552725,-73.97121888345923\n40.64695121142032,-73.78948684595835\n40.707432369923744,-73.81832235167411\n40.714256030826796,-73.9589562408558\n40.76116132626682,-74.00017117034147\n40.80778022664844,-73.96301120134817\n40.721274454361726,-74.00930188605581\n40.74578362589791,-73.97332255947087\n40.748292242262565,-73.98367679055663\n40.774424362071834,-73.95637686072985\n40.728840618920415,-73.731274695685\n40.73247459247343,-74.00110701428575\n40.76301338115157,-73.96871549519679\n40.66089711480419,-73.95676235449167\n40.72390415616087,-73.98662268552216\n40.729375766736474,-73.84247790507132\n40.726792856790894,-74.05776093595253\n40.77389074605923,-73.98095853442489\n40.809357726959924,-73.9405977589622\n40.713405928669225,-74.01487267034153\n40.74449870388764,-73.95161854074186\n40.75036702645151,-73.99272580078892\n40.74386366427867,-73.98159519737288\n40.79514753225311,-73.97175242442134\n40.691716385546634,-73.96746677570458\n40.62596418577597,-74.02318405809878\n40.74472188289315,-73.90320586289172\n40.75795860127306,-73.96437398466873\n40.69902288757731,-74.17901082465455\n40.78606177705568,-73.95272224205782\n40.73288060226214,-73.99111751319067\n40.714129310368634,-74.00811111844598\n40.742127864110685,-73.79572358513816\n40.74943249754878,-73.97724724246244\n40.72051565511787,-74.00426147163428\n40.761024032487285,-73.98471219478782\n40.73895291307298,-74.00162670161268\n40.724175630435646,-73.95298043691055\n40.76117658497192,-73.99486809335785\n40.727189228662986,-73.9973348387262\n40.876082099055,-73.83666567462528\n40.74395906450927,-73.92124392984304\n40.85334457648353,-74.12020466537007\n40.75870221353383,-73.9309047816642\n40.62602906646551,-73.96937944312627\n40.61295825626847,-73.91889013281234\n40.765954387791346,-73.99418099471806\n40.77584446440822,-73.9467052969005\n40.65933678889752,-73.99476492630207\n40.75829136531837,-73.97708497535491\n40.76704234106632,-73.95404550189548\n40.70111315220996,-73.98983524521616\n40.73773989098946,-73.98344792245878\n40.764388832200915,-73.97663312899802\n40.75419460090831,-73.97431220923859\n40.64566812574546,-73.78053355016131\n40.77648946147613,-73.9872780273302\n40.78000259645291,-73.9808100425107\n40.82723477356863,-73.94820105437181\n40.78097961305549,-73.94879496003541\n40.772127925742765,-73.95108309052925\n40.6582393051656,-73.79938208648177\n40.75180252587517,-73.93937293303166\n40.74984770588913,-73.98811295856127\n40.76149457811802,-73.98883674471696\n40.77897005624138,-73.96066817041294\n40.6773966427137,-73.9678939981277\n40.782440188818974,-73.97316396526391\n40.768539430594686,-73.98216522861318\n40.737097396093596,-73.99550281617044\n40.75656041065771,-73.99079047190715\n40.769662159359285,-74.03326288881688\n40.82133562847779,-73.92482326012134\n40.742263246752394,-73.99820429335176\n40.763350807994556,-73.96469146397418\n40.754990367142106,-73.96771431706068\n40.69269619508268,-73.99300062695349\n40.77260985400584,-73.92006967933489\n40.726290044592346,-73.9923321741711\n40.75296229264851,-73.97907381334926\n40.739677358536284,-74.00658336574548\n40.67389116572828,-73.92049431665573\n40.7968650826829,-73.93828299940384\n40.755300955473906,-73.99813337136403\n40.76966887310245,-73.98933455283347\n40.791511827983,-73.9669695118212\n40.721857148194246,-73.99441610110249\n40.66872931324449,-73.86659891545249\n40.705117079960225,-74.0134467769515\n40.7386065483966,-73.98926678545857\n40.86974180547433,-73.90034822197237\n40.731889633573424,-73.8668973418396\n40.75600448529597,-73.98476476156499\n40.77856338031329,-73.95446747085917\n40.816079204227606,-73.9571497977144\n40.75069844077088,-73.97156623405898\n40.79883551838388,-73.96132565567827\n40.765425505862936,-73.98022376418173\n40.78926976549778,-73.97438517809883\n40.58790532564684,-74.16500053548948\n40.726867017748724,-74.00374299086658\n40.7696219448896,-73.86364186754744\n40.73068496798476,-73.98637386329355\n40.76207106674746,-73.98037757529902\n40.8016764256366,-73.96766160824384\n40.687123158657606,-73.98968861532794\n40.74681418012195,-73.99909716127652\n40.833408585862905,-73.86364446679748\n40.80537884428599,-73.95409977073558\n40.76400629975985,-73.92413161002807\n40.715999386308795,-73.99366156643532\n40.681822459563584,-73.80562588203243\n40.68605051813042,-73.95121764379907\n40.862589905554486,-73.92718848134498\n40.7629310478654,-73.97314061623655\n40.67221548609755,-73.98414270404776\n40.74268480836436,-73.97713944871317\n40.6835824514527,-73.97792280514182\n40.71090835444687,-73.94507460204532\n40.76594561962316,-73.95723005733558\n40.732983244345576,-74.00680686798306\n40.69403873737802,-73.85051387371132\n40.7705985845651,-73.95861049938223\n40.71943114823973,-73.98785558709065\n40.76159797049886,-73.9599811166664\n40.790352428482144,-73.9482331586887\n40.782861156440745,-73.9561693768501\n40.76764119539901,-73.9624520880682\n40.769237172605806,-73.96716673049\n40.79997560196636,-73.94829804371975\n40.76042389666173,-73.88854838761047\n40.74405273501506,-73.9929071672932\n40.69305946097673,-73.98319935669498\n40.725237274362215,-73.98086736034497\n40.744578254855874,-73.88577467141282\n"}]},"apps":[],"jobName":"paragraph_1494299130427_1819158870","id":"20170508-230530_906857626","dateCreated":"2017-05-08T23:05:30-0400","dateStarted":"2017-05-08T23:16:29-0400","dateFinished":"2017-05-08T23:16:29-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14552"},{"text":"clusterDF.createOrReplaceTempView(\"clusterDF\")","user":"anonymous","dateUpdated":"2017-05-08T21:02:05-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1494252654555_-1989718297","id":"20170508-101054_599476738","dateCreated":"2017-05-08T10:10:54-0400","dateStarted":"2017-05-08T21:02:05-0400","dateFinished":"2017-05-08T21:02:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14553"},{"text":"%sql\nselect pickupCluster, count(*) as num\nfrom clusterDF\ngroup by pickupCluster","user":"anonymous","dateUpdated":"2017-05-09T10:29:10-0400","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"pickupCluster\tnum\n148\t3164283\n31\t61768\n85\t8955436\n137\t3472329\n65\t4249452\n53\t2761747\n133\t792067\n78\t6497373\n108\t5633874\n34\t4551143\n101\t2776638\n115\t5053151\n126\t96178\n81\t356928\n28\t174335\n76\t217802\n26\t6737888\n27\t7046926\n44\t3594853\n103\t3386473\n12\t4294877\n91\t938422\n22\t2819103\n128\t97462\n122\t45414\n93\t5581268\n111\t1300801\n47\t23163\n140\t1385197\n132\t769012\n146\t7469464\n1\t4191715\n52\t834413\n13\t4352564\n6\t3977147\n16\t1713332\n86\t59948\n3\t4490212\n142\t3889903\n20\t1619085\n40\t50511\n139\t2857594\n94\t7587303\n57\t13803\n54\t4455747\n120\t475514\n96\t80439\n48\t6117965\n5\t5607896\n19\t2247809\n92\t363264\n117\t6585147\n64\t5569063\n41\t349151\n15\t7440183\n43\t46995\n112\t3978158\n37\t6088781\n61\t2204375\n127\t304542\n88\t3179289\n107\t7104023\n9\t385981\n17\t119089\n72\t6141181\n35\t562417\n114\t7039\n4\t1572475\n59\t125934\n55\t14533\n8\t4520480\n100\t3199848\n23\t5890770\n39\t306605\n49\t3695026\n7\t672768\n130\t498161\n84\t5890308\n136\t23677\n87\t161641\n51\t4207934\n129\t7039227\n69\t6773857\n97\t1155260\n63\t128335\n10\t4143765\n77\t843654\n102\t20932\n50\t6386551\n45\t6556427\n38\t3128455\n82\t3865342\n80\t4125068\n73\t643474\n25\t21617\n113\t4053545\n24\t4117084\n70\t4691593\n121\t3041528\n62\t3489958\n125\t1958076\n143\t3868391\n95\t5562704\n29\t4205738\n21\t2932732\n98\t2946692\n90\t4082580\n32\t6532777\n60\t19776\n75\t3953345\n141\t3859120\n145\t233652\n109\t889175\n56\t774069\n105\t54596\n58\t481254\n11\t6486251\n33\t924112\n83\t5287309\n110\t3880994\n68\t3449664\n71\t2627403\n106\t134777\n116\t4455187\n147\t595451\n14\t343286\n123\t812715\n135\t4151900\n119\t2485469\n42\t4258420\n79\t4772617\n2\t5592818\n131\t4731992\n149\t253279\n118\t5793184\n124\t723794\n99\t2729993\n30\t151351\n66\t554542\n46\t4673983\n67\t5103078\n144\t615363\n0\t378627\n18\t2129487\n74\t3736243\n138\t4332929\n104\t7323023\n134\t2490566\n36\t13567500\n89\t4321799\n"}]},"apps":[],"jobName":"paragraph_1494277739791_328673023","id":"20170508-170859_1813224148","dateCreated":"2017-05-08T17:08:59-0400","dateStarted":"2017-05-08T22:33:23-0400","dateFinished":"2017-05-08T22:55:41-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14554"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1494372878193_-1778606332","id":"20170509-193438_88142375","dateCreated":"2017-05-09T19:34:38-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:14555"}],"name":"trainKMeansModel","id":"2CHPYZJPP","angularObjects":{"2CFJKQVBN:shared_process":[],"2CF295UYG:shared_process":[],"2CDUTWP3P:shared_process":[],"2CD6ZRPDJ:shared_process":[],"2CG949ZHZ:shared_process":[],"2CG23YGEZ:shared_process":[],"2CEJ86HV3:shared_process":[],"2CEZMWG72:shared_process":[],"2CDY97F39:shared_process":[],"2CFXK5J4Y:shared_process":[],"2CFXDXWCE:shared_process":[],"2CEZV3CHG:shared_process":[],"2CDM4T1EH:shared_process":[],"2CEC5KMFB:shared_process":[],"2CFWFHNZR:shared_process":[],"2CFG6Y8G3:shared_process":[],"2CGYXR37V:shared_process":[],"2CFFWS5P3:shared_process":[],"2CFGNABPQ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}